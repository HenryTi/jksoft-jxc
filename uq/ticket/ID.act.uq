ACT SaveItem ver 0.1 (
    IDType CHAR(100),
    pNo CHAR(20),
	ex CHAR(200),
)
RETURNS ret (
    id ID,
) {
    VAR base ID;
    PROC BaseItem(IDType, base);

    -- 判断是不是已经有同编号的输入了。比如，我正在输入的时候，别人也输入了。
    VAR id ID;
    SET id = ID(Item KEY base=base, no=pNo);
    IF id IS NULL {
        SET id = ID(Item new KEY base=base,no=pNo);
        WITH Item as a ID=id SET a.ex=ex;
    }
    ELSE {
        SET id=-id;
    }
    INTO ret SELECT id;
};
